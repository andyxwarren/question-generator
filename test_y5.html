<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Y5 N06 Generator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        .question {
            background: #f5f5f5;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .options {
            margin-top: 10px;
        }
        .option {
            padding: 8px;
            margin: 5px 0;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        .error {
            color: red;
            padding: 10px;
            background: #ffe6e6;
            border-radius: 4px;
        }
        .success {
            color: green;
            padding: 10px;
            background: #e6ffe6;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <h1>Year 5 N06 Number Problems - Generator Test</h1>

    <div>
        <label>Level:
            <select id="levelSelect">
                <option value="1">Level 1 (Beginning)</option>
                <option value="2">Level 2 (Developing)</option>
                <option value="3" selected>Level 3 (Meeting)</option>
                <option value="4">Level 4 (Exceeding)</option>
            </select>
        </label>
        <button onclick="generateQuestion()">Generate Question</button>
        <button onclick="generateMultiple()">Generate 5 Questions</button>
    </div>

    <div id="output"></div>

    <script type="module">
        import questionEngine from './src/core/questionEngine.js';

        window.generateQuestion = function() {
            const level = parseInt(document.getElementById('levelSelect').value);
            const output = document.getElementById('output');

            try {
                const question = questionEngine.generateOne('N06_Y5_NPV', level);

                if (!question) {
                    output.innerHTML = '<div class="error">Failed to generate question</div>';
                    return;
                }

                let html = `<div class="question">
                    <p><strong>Question:</strong> ${question.text}</p>
                    <p><strong>Type:</strong> ${question.type}</p>
                    <p><strong>Level:</strong> ${question.level}</p>
                `;

                if (question.type === 'multiple_choice' && question.options) {
                    html += '<div class="options"><strong>Options:</strong>';
                    question.options.forEach(opt => {
                        const isCorrect = opt.toString() === question.answer;
                        html += `<div class="option" style="${isCorrect ? 'background: #e6ffe6;' : ''}">${opt}</div>`;
                    });
                    html += '</div>';
                }

                html += `<p><strong>Answer:</strong> ${question.answer}</p>`;
                if (question.hint) {
                    html += `<p><strong>Hint:</strong> ${question.hint}</p>`;
                }
                html += `<p style="font-size: 0.8em; color: #666;">ID: ${question.id}</p>`;
                html += '</div>';

                output.innerHTML = html;
            } catch (error) {
                output.innerHTML = `<div class="error">Error: ${error.message}<br>${error.stack}</div>`;
            }
        };

        window.generateMultiple = function() {
            const level = parseInt(document.getElementById('levelSelect').value);
            const output = document.getElementById('output');

            try {
                const questions = questionEngine.generate('N06_Y5_NPV', level, 5);

                if (!questions || questions.length === 0) {
                    output.innerHTML = '<div class="error">Failed to generate questions</div>';
                    return;
                }

                let html = `<div class="success">Successfully generated ${questions.length} questions</div>`;

                questions.forEach((question, idx) => {
                    html += `<div class="question">
                        <p><strong>Question ${idx + 1}:</strong> ${question.text}</p>
                        <p><strong>Type:</strong> ${question.type}</p>
                    `;

                    if (question.type === 'multiple_choice' && question.options) {
                        html += '<div class="options"><strong>Options:</strong>';
                        question.options.forEach(opt => {
                            const isCorrect = opt.toString() === question.answer;
                            html += `<div class="option" style="${isCorrect ? 'background: #e6ffe6;' : ''}">${opt}</div>`;
                        });
                        html += '</div>';
                    }

                    html += `<p><strong>Answer:</strong> ${question.answer}</p>`;
                    if (question.hint) {
                        html += `<p><strong>Hint:</strong> ${question.hint}</p>`;
                    }
                    html += '</div>';
                });

                output.innerHTML = html;
            } catch (error) {
                output.innerHTML = `<div class="error">Error: ${error.message}<br>${error.stack}</div>`;
            }
        };

        // Auto-generate one question on load
        window.addEventListener('load', () => {
            generateQuestion();
        });
    </script>
</body>
</html>
